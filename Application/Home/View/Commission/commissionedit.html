<html>
<head>
	<meta charset="utf-8">
	<title>佣金管理</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"><!-- 最新版本渲染 -->
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/audit_rent_orders.css">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/basic.css">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/css/common.css">
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/plug/jquery.datetimepicker.css"/>
</head>
<body>
<include file="Public/head_city" />
    <div class="title cf">
    	<div class="logo fl cf">
			<img src="__PUBLIC__/images/logo.png">
		</div>
		<ul class="cf fl">
			<li><a href="{:U('Welcome/welcome')}">首页</a></li>
			{$menutophtml}
		</ul>
		<div class="cf fr title_right">
			<a class="blue" href="javascript:">欢迎您 <?php echo cookie("admin_user_name");?></a>
			<span>|</span>
			<a href="{:U('/Index/outlogin')}">退出</a>
		</div>
    </div>
	<div class="main">
		<div class="main_left subNavBox">
			<include file="Public/left_menu" />
			{$menulefthtml}
		</div>
		<div class="main_right">
			<div class="common_head">
				<h2>佣金规则</h2>
			</div>
			<div class="common_main">
				<div style="font-size:16px;margin:30px 0 30px 50px;">房间编号：{$Model['room_no']}&nbsp;&nbsp;&nbsp;&nbsp;租金：{$Model['room_money']}</div>
				<div style="font-size:16px;margin:30px 0 30px 50px;">合同时长：<gt name="Model.contracttime_start" value="0">{$Model['contracttime_start']}</gt>~<lt name="Model.contracttime_end" value="99">{$Model['contracttime_end']}</lt></div>
				<table class="table_one table_two" style="margin:30px 0 30px 50px;width:70%;text-align:center;">
						<thead>
							<tr>
								<th>计算方式</th>
								<th>佣金基数</th>
								<th>百分比/金额</th>
								<th>在线支付是否扣佣</th>
								<th>结算方式</th>
								<th>启用时间</th>
								<th>截止时间</th>
								<th>创建时间</th>
							</tr>
						</thead>
						<tbody>
							<foreach item="vo" name="list">
							<tr>
								<td><switch name="vo.commission_type"><case value="1">百分比</case><case value="2">金额</case><default /></switch></td>
								<td><switch name="vo.commission_base"><case value="1">1个月</case><case value="2">合同金额</case><case value="3">1年</case><default /></switch></td>
								<td><switch name="vo.commission_type"><case value="1">{$vo.commission_money}%</case><case value="2">{$vo.commission_money}</case><default /></switch></td>
								<td><if condition="($vo.is_online eq 1)">是<else/>否</if></td>
								<td><switch name="vo.settlement_method"><case value="1">次结</case><case value="2">月结</case><default /></switch></td>								
								<td><if condition="($vo.start_time gt 0)">{$vo.start_time|date="Y-m-d H:i:s",###}</if></td>
								<td><if condition="($vo.end_time gt 0)">{$vo.end_time|date="Y-m-d H:i:s",###}</if></td>
								<td><if condition="($vo.create_time gt 0)">{$vo.create_time|date="Y-m-d H:i:s",###}</if></td>
							</tr>
							</foreach>
						</tbody>
					</table>
				
			</div>
			<div id="divAdd" style="display:none"><a href="javascript:;" class="btn_a" id="btnAdd" style="margin:0 50px;">新增</a></div>
			<div id="divPost" style="display:none">
				<form method="post" action="__URL__/saveCommission" style="margin:30px 0 30px 50px;width:100%;text-align:center;">
					<input type="hidden" name="id" value="{$Model['id']}">
					<table class="table_one table_two">
						
						<tr>
							<td class="td_title">计算方式：</td>
							<td class="td_main"><label><input type="radio" name="commission_type" value="1" checked="checked">百分比</label>&nbsp;
								<label><input type="radio" name="commission_type" value="2">金额</label>&nbsp;&nbsp;&nbsp;
								<span id="commission_base" style="color:black;">佣金基数&nbsp;<label><input type="radio" name="commission_base" value="1" checked="checked">1个月</label>&nbsp;
								<label><input type="radio" name="commission_base" value="2">合同金额</label>&nbsp;
								<label><input type="radio" name="commission_base" value="3">1年</label></span>
							</td>
						</tr>
						<tr>
							<td class="td_title">佣金：</td>
							<td class="td_main"><input type="text" name="commission_money" style="width:100px;"><label id="commission_money">&nbsp;%</label></td>
						</tr>
						<tr>
							<td class="td_title">在线付租是否扣佣：</td>
							<td class="td_main"><label><input type="radio" name="is_online" value="1" checked="checked">是</label>&nbsp;
								<label><input type="radio" name="is_online" value="0">否</label>&nbsp;</td>
						</tr>
						<tr>
							<td class="td_title">结算方式：</td>
							<td class="td_main"><label><input type="radio" name="settlement_method" value="1" checked="checked">次结</label>&nbsp;
								<label><input type="radio" name="settlement_method" value="2">月结</label>&nbsp;</td>
						</tr>
						<tr>
							<td class="td_title">启用时间：</td>
							<td class="td_main"><input class="inpt_a" type="text" name="start_time"></td>
						</tr>
					</table>
					</form>
				<div><a href="javascript:;" class="btn_a" id="btnSubmit" style="margin-left:35%;">提交</a></div>
			</div>
		</div>
	</div>
</body>
 <script src="__PUBLIC__/js/jquery.js"></script>
 <script src="__PUBLIC__/js/common.js"></script>
  <script src="__PUBLIC__/plug/jquery.datetimepicker.js"></script>
<script type="text/javascript">
$('.inpt_a').datetimepicker({step:5,lang:'ch',timepicker:false,yearStart:2016,yearEnd:2018,format:"Y-m-d"});

if("{$Model['is_open']}"=='1'){
	$("#divAdd").show();
}
$("input[name='commission_type']").change(function() {
	if($(this).val()=="2"){
		$("#commission_base").hide();$("#commission_money").text("元");
	}else{
		$("#commission_base").show();$("#commission_money").text("%");
	}
})
$("#btnAdd").click(function(){
	$("#divPost").show();
});
/*提交 */
$('#btnSubmit').bind('click',function(){
	var regNum=/^[0-9.]{1,5}$/;
	var money=$("input[name='commission_money']").val();
	if(!regNum.test(money)){
		alert("请输入有效佣金");return;
	}
	if($("#commission_money").text()=="%" && parseFloat(money)>100){
		alert("请输入有效佣金");return;
	}
	if($("input[name='start_time']").val()==""){
		alert("请输入启用时间");return;
	}
	$(this).unbind('click').text('提交中');
	$("form").submit();
});
</script>
</html>
